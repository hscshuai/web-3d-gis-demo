import{b as fa}from"./chunk-2LG3RMGY.js";import{b as ua}from"./chunk-DFSS7SUW.js";import{a as j}from"./chunk-NPTAZJMT.js";import{a as K,b as ma,c as ea}from"./chunk-XEPXWER2.js";import{a as ra}from"./chunk-YYDDZ7VD.js";import{a as d}from"./chunk-RR7RQKIV.js";import{a as ta}from"./chunk-EYID6YYM.js";import{a as T,b as va}from"./chunk-KEUENCTW.js";import{a as Q}from"./chunk-4CMOBRL4.js";import{b as N}from"./chunk-ZH6AYVQ4.js";import{a}from"./chunk-LOWC4Y7I.js";import{a as g}from"./chunk-MOORIFFX.js";import{a as X}from"./chunk-UBHQMGET.js";import{a as G}from"./chunk-EDZQSM3T.js";import{a as P}from"./chunk-PJGSCWXZ.js";import{a as l}from"./chunk-NUC3LT2W.js";var f=[];f[0]={num:0,des:"inside"};f[1]={num:4,data:[0,4,7,3],des:"left"};f[2]={num:4,data:[1,2,6,5],des:"right"};f[3]={num:0};f[4]={num:4,data:[0,1,5,4],des:"bottom"};f[5]={num:6,data:[0,1,5,4,7,3],des:"bottom, left"};f[6]={num:6,data:[0,1,2,6,5,4],des:"bottom, right"};f[7]={num:0};f[8]={num:4,data:[2,3,7,6],des:"top"};f[9]={num:6,data:[4,7,6,2,3,0],des:"top, left"};f[10]={num:6,data:[2,3,7,6,5,1],des:"top, right"};f[11]={num:0};f[12]={num:0};f[13]={num:0};f[14]={num:0};f[15]={num:0};f[16]={num:4,data:[0,3,2,1],des:"front"};f[17]={num:6,data:[0,4,7,3,2,1],des:"front, left"};f[18]={num:6,data:[0,3,2,6,5,1],des:"front, right"};f[19]={num:0};f[20]={num:6,data:[0,3,2,1,5,4],des:"front, bottom"};f[21]={num:6,data:[2,1,5,4,7,3],des:"front, bottom, left"};f[22]={num:6,data:[0,3,2,6,5,4],des:"front, bottom, right"};f[23]={num:0};f[24]={num:6,data:[0,3,7,6,2,1],des:"front, top"};f[25]={num:6,data:[0,4,7,6,2,1],des:"front, top, left"};f[26]={num:6,data:[0,3,7,6,5,1],des:"front, top, right"};f[27]={num:0};f[28]={num:0};f[29]={num:0};f[30]={num:0};f[31]={num:0};f[32]={num:4,data:[4,5,6,7],des:"back"};f[33]={num:6,data:[4,5,6,7,3,0],des:"back, left"};f[34]={num:6,data:[1,2,6,7,4,5],des:"back, right"};f[35]={num:0};f[36]={num:6,data:[0,1,5,6,7,4],des:"back, bottom"};f[37]={num:6,data:[0,1,5,6,7,3],des:"back, bottom, left"};f[38]={num:6,data:[0,1,2,6,7,4],des:"back, bottom, right"};f[39]={num:0};f[40]={num:6,data:[2,3,7,4,5,6],des:"back, top"};f[41]={num:6,data:[0,4,5,6,2,3],des:"back, top, left"};f[42]={num:6,data:[1,2,3,7,4,5],des:"back, top, right"};function p(t,r){this.center=a.clone(X(t,a.ZERO)),this.halfAxes=d.clone(X(r,d.ZERO)),this.areaDirty=1}p.packedLength=a.packedLength+d.packedLength;p.pack=function(t,r,e){return G.typeOf.object("value",t),G.defined("array",r),e=X(e,0),a.pack(t.center,r,e),d.pack(t.halfAxes,r,e+a.packedLength),r};p.unpack=function(t,r,e){return G.defined("array",t),r=X(r,0),l(e)||(e=new p),a.unpack(t,r,e.center),d.unpack(t,r+a.packedLength,e.halfAxes),e};var Na=new a,Ta=new a,Ra=new a,Ca=new a,ba=new a,Ma=new a,Ba=new d,Pa={unitary:new d,diagonal:new d},U=new a,I=new a,y=new a;p.fromPoints=function(t,r){if(l(r)||(r=new p),!l(t)||t.length===0)return r.halfAxes=d.ZERO,r.center=a.ZERO,r;var e,s=t.length,c=a.clone(t[0],Na);for(e=1;e<s;e++)a.add(c,t[e],c);var i=1/s;a.multiplyByScalar(c,i,c);var m=0,x=0,u=0,w=0,h=0,n=0,o;for(e=0;e<s;e++)o=a.subtract(t[e],c,Ta),m+=o.x*o.x,x+=o.x*o.y,u+=o.x*o.z,w+=o.y*o.y,h+=o.y*o.z,n+=o.z*o.z;m*=i,x*=i,u*=i,w*=i,h*=i,n*=i;var v=Ba;v[0]=m,v[1]=x,v[2]=u,v[3]=x,v[4]=w,v[5]=h,v[6]=u,v[7]=h,v[8]=n;var C=d.computeEigenDecomposition(v,Pa),R=d.clone(C.unitary,r.halfAxes),z=d.getColumn(R,0,Ca),A=d.getColumn(R,1,ba),O=d.getColumn(R,2,Ma),M=-Number.MAX_VALUE,b=-Number.MAX_VALUE,k=-Number.MAX_VALUE,S=Number.MAX_VALUE,L=Number.MAX_VALUE,B=Number.MAX_VALUE;for(e=0;e<s;e++)o=t[e],M=Math.max(a.dot(z,o),M),b=Math.max(a.dot(A,o),b),k=Math.max(a.dot(O,o),k),S=Math.min(a.dot(z,o),S),L=Math.min(a.dot(A,o),L),B=Math.min(a.dot(O,o),B);z=a.multiplyByScalar(z,.5*(S+M),z),A=a.multiplyByScalar(A,.5*(L+b),A),O=a.multiplyByScalar(O,.5*(B+k),O);var D=a.add(z,A,r.center);a.add(D,O,D);var E=Ra;return E.x=M-S,E.y=b-L,E.z=k-B,a.multiplyByScalar(E,.5,E),d.multiplyByScale(r.halfAxes,E,r.halfAxes),r};var za=new a,Ia=new a;function wa(t,r,e,s,c,i,m,x,u,w,h){if(!l(c)||!l(i)||!l(m)||!l(x)||!l(u)||!l(w))throw new P("all extents (minimum/maximum X/Y/Z) are required.");l(h)||(h=new p);var n=h.halfAxes;d.setColumn(n,0,r,n),d.setColumn(n,1,e,n),d.setColumn(n,2,s,n);var o=za;o.x=(c+i)/2,o.y=(m+x)/2,o.z=(u+w)/2;var v=Ia;v.x=(i-c)/2,v.y=(x-m)/2,v.z=(w-u)/2;var C=h.center;return o=d.multiplyByVector(n,o,o),a.add(t,o,C),d.multiplyByScale(n,v,n),h}var pa=new N,Sa=new a,La=new N,qa=new N,ka=new N,Da=new N,Ua=new N,Xa=new a,xa=new a,Va=new a,ya=new a,ja=new a,Wa=new T,_a=new T,Za=new T,Ya=new T,Fa=new T,Ga=new a,Ja=new a,Ka=new a,Qa=new a,$a=new T,Ha=new a,ar=new a,rr=new a,tr=new j(a.UNIT_X,0);p.fromRectangle=function(t,r,e,s,c){if(!l(t))throw new P("rectangle is required");if(t.width<0||t.width>g.TWO_PI)throw new P("Rectangle width must be between 0 and 2*pi");if(t.height<0||t.height>g.PI)throw new P("Rectangle height must be between 0 and pi");if(l(s)&&!g.equalsEpsilon(s.radii.x,s.radii.y,g.EPSILON15))throw new P("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");r=X(r,0),e=X(e,0),s=X(s,va.WGS84);var i,m,x,u,w,h,n;if(t.width<=g.PI){var o=ta.center(t,pa),v=s.cartographicToCartesian(o,Sa),C=new fa(v,s);n=C.plane;var R=o.longitude,z=t.south<0&&t.north>0?0:o.latitude,A=N.fromRadians(R,t.north,e,La),O=N.fromRadians(t.west,t.north,e,qa),M=N.fromRadians(t.west,z,e,ka),b=N.fromRadians(t.west,t.south,e,Da),k=N.fromRadians(R,t.south,e,Ua),S=s.cartographicToCartesian(A,Xa),L=s.cartographicToCartesian(O,xa),B=s.cartographicToCartesian(M,Va),D=s.cartographicToCartesian(b,ya),E=s.cartographicToCartesian(k,ja),Z=C.projectPointToNearestOnPlane(S,Wa),V=C.projectPointToNearestOnPlane(L,_a),q=C.projectPointToNearestOnPlane(B,Za),Y=C.projectPointToNearestOnPlane(D,Ya),J=C.projectPointToNearestOnPlane(E,Fa);return i=Math.min(V.x,q.x,Y.x),m=-i,u=Math.max(V.y,Z.y),x=Math.min(Y.y,J.y),O.height=b.height=r,L=s.cartographicToCartesian(O,xa),D=s.cartographicToCartesian(b,ya),w=Math.min(j.getPointDistance(n,L),j.getPointDistance(n,D)),h=e,wa(C.origin,C.xAxis,C.yAxis,C.zAxis,i,m,x,u,w,h,c)}var F=t.south>0,ia=t.north<0,H=F?t.south:ia?t.north:0,sa=ta.center(t,pa).longitude,_=a.fromRadians(sa,H,e,s,Ga);_.z=0;var Oa=Math.abs(_.x)<g.EPSILON10&&Math.abs(_.y)<g.EPSILON10,aa=Oa?a.UNIT_X:a.normalize(_,Ja),ha=a.UNIT_Z,da=a.cross(aa,ha,Ka);n=j.fromPointNormal(_,aa,tr);var Ea=a.fromRadians(sa+g.PI_OVER_TWO,H,e,s,Qa);m=a.dot(j.projectPointOntoPlane(n,Ea,$a),da),i=-m,u=a.fromRadians(0,t.north,ia?r:e,s,Ha).z,x=a.fromRadians(0,t.south,F?r:e,s,ar).z;var ga=a.fromRadians(t.east,H,e,s,rr);return w=j.getPointDistance(n,ga),h=0,wa(_,da,ha,aa,i,m,x,u,w,h,c)};p.clone=function(t,r){if(!!l(t))return l(r)?(a.clone(t.center,r.center),d.clone(t.halfAxes,r.halfAxes),r.areaDirty=1,r):new p(t.center,t.halfAxes)};p.intersectPlane=function(t,r){if(!l(t))throw new P("box is required.");if(!l(r))throw new P("plane is required.");var e=t.center,s=r.normal,c=t.halfAxes,i=s.x,m=s.y,x=s.z,u=Math.abs(i*c[d.COLUMN0ROW0]+m*c[d.COLUMN0ROW1]+x*c[d.COLUMN0ROW2])+Math.abs(i*c[d.COLUMN1ROW0]+m*c[d.COLUMN1ROW1]+x*c[d.COLUMN1ROW2])+Math.abs(i*c[d.COLUMN2ROW0]+m*c[d.COLUMN2ROW1]+x*c[d.COLUMN2ROW2]),w=a.dot(s,e)+r.distance;return w<=-u?K.OUTSIDE:w>=u?K.INSIDE:K.INTERSECTING};var na=new a,oa=new a,ca=new a,er=new a,nr=new a;p.distanceSquaredTo=function(t,r){if(!l(t))throw new P("box is required.");if(!l(r))throw new P("cartesian is required.");var e=a.subtract(r,t.center,za),s=t.halfAxes,c=d.getColumn(s,0,na),i=d.getColumn(s,1,oa),m=d.getColumn(s,2,ca),x=a.magnitude(c),u=a.magnitude(i),w=a.magnitude(m);a.normalize(c,c),a.normalize(i,i),a.normalize(m,m);var h=er;h.x=a.dot(e,c),h.y=a.dot(e,i),h.z=a.dot(e,m);var n=0,o;return h.x<-x?(o=h.x+x,n+=o*o):h.x>x&&(o=h.x-x,n+=o*o),h.y<-u?(o=h.y+u,n+=o*o):h.y>u&&(o=h.y-u,n+=o*o),h.z<-w?(o=h.z+w,n+=o*o):h.z>w&&(o=h.z-w,n+=o*o),n};var Aa=new a,or=new a;p.computePlaneDistances=function(t,r,e,s){if(!l(t))throw new P("box is required.");if(!l(r))throw new P("position is required.");if(!l(e))throw new P("direction is required.");l(s)||(s=new ma);var c=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,m=t.center,x=t.halfAxes,u=d.getColumn(x,0,na),w=d.getColumn(x,1,oa),h=d.getColumn(x,2,ca),n=a.add(u,w,Aa);a.add(n,h,n),a.add(n,m,n);var o=a.subtract(n,r,or),v=a.dot(e,o);return c=Math.min(v,c),i=Math.max(v,i),a.add(m,u,n),a.add(n,w,n),a.subtract(n,h,n),a.subtract(n,r,o),v=a.dot(e,o),c=Math.min(v,c),i=Math.max(v,i),a.add(m,u,n),a.subtract(n,w,n),a.add(n,h,n),a.subtract(n,r,o),v=a.dot(e,o),c=Math.min(v,c),i=Math.max(v,i),a.add(m,u,n),a.subtract(n,w,n),a.subtract(n,h,n),a.subtract(n,r,o),v=a.dot(e,o),c=Math.min(v,c),i=Math.max(v,i),a.subtract(m,u,n),a.add(n,w,n),a.add(n,h,n),a.subtract(n,r,o),v=a.dot(e,o),c=Math.min(v,c),i=Math.max(v,i),a.subtract(m,u,n),a.add(n,w,n),a.subtract(n,h,n),a.subtract(n,r,o),v=a.dot(e,o),c=Math.min(v,c),i=Math.max(v,i),a.subtract(m,u,n),a.subtract(n,w,n),a.add(n,h,n),a.subtract(n,r,o),v=a.dot(e,o),c=Math.min(v,c),i=Math.max(v,i),a.subtract(m,u,n),a.subtract(n,w,n),a.subtract(n,h,n),a.subtract(n,r,o),v=a.dot(e,o),c=Math.min(v,c),i=Math.max(v,i),s.start=c,s.stop=i,s};var cr=new ea;p.isOccluded=function(t,r){if(!l(t))throw new P("box is required.");if(!l(r))throw new P("occluder is required.");var e=ea.fromOrientedBoundingBox(t,cr);return!r.isBoundingSphereVisible(e)};p.prototype.intersectPlane=function(t){return p.intersectPlane(this,t)};p.prototype.distanceSquaredTo=function(t){return p.distanceSquaredTo(this,t)};p.prototype.computePlaneDistances=function(t,r,e){return p.computePlaneDistances(this,t,r,e)};p.prototype.isOccluded=function(t){return p.isOccluded(this,t)};p.equals=function(t,r){return t===r||l(t)&&l(r)&&a.equals(t.center,r.center)&&d.equals(t.halfAxes,r.halfAxes)};p.prototype.clone=function(t){return p.clone(this,t)};p.prototype.equals=function(t){return p.equals(this,t)};var la=new Q;p.prototype._updateBBox=function(){if(this.areaDirty==1){var t=d.getColumn(this.halfAxes,0,na),r=a.clone(a.negate(t,U)),e=d.getColumn(this.halfAxes,1,oa),s=a.clone(a.negate(e,U)),c=d.getColumn(this.halfAxes,2,ca),i=a.clone(a.negate(c,U));this.bbox=[],a.add(this.center,e,U),a.add(U,i,I),a.add(I,r,y),this.bbox[0]=new a(y.x,y.y,y.z),a.add(I,t,y),this.bbox[1]=new a(y.x,y.y,y.z),a.add(U,c,I),a.add(I,t,y),this.bbox[2]=new a(y.x,y.y,y.z),a.add(I,r,y),this.bbox[3]=new a(y.x,y.y,y.z),a.add(this.center,s,U),a.add(U,i,I),a.add(I,r,y),this.bbox[4]=new a(y.x,y.y,y.z),a.add(I,t,y),this.bbox[5]=new a(y.x,y.y,y.z),a.add(U,c,I),a.add(I,t,y),this.bbox[6]=new a(y.x,y.y,y.z),a.add(I,r,y),this.bbox[7]=new a(y.x,y.y,y.z);var m=a.magnitude(t),x=a.magnitude(e),u=a.magnitude(c),w=new a(-m,-x,-u),h=new a(m,x,u);if(m*x*u==0){this.areaDirty=-1;return}a.normalize(t,t),a.normalize(e,e),a.normalize(c,c),this.u=a.clone(t),this.v=a.clone(e),this.w=a.clone(c),this.posMin=w,this.posMaX=h,this.areaDirty=0}};var W=[];W.push(new T);W.push(new T);W.push(new T);W.push(new T);W.push(new T);W.push(new T);var ir=new N,$=new a;p.prototype.calculateBoxArea=function(t,r,e,s,c,i,m,x){this._updateBBox();var u=t,w=a.subtract(u,this.center,nr);if(this.areaDirty==-1){var h=i!=-1?i:a.distance(this.posMaX,this.posMin)*.5,n=c,o=n/s,v=o*h/e;return g.PI*v*v}var C=a.fromElements(a.dot(w,this.u),a.dot(w,this.v),a.dot(w,this.w),Aa),R=C.x<this.posMin.x?1:0,z=C.x>this.posMaX.x?1:0,A=C.z<this.posMin.z?1:0,O=C.z>this.posMaX.z?1:0,M=C.y>this.posMaX.y?1:0,b=C.y<this.posMin.y?1:0,k=R+(z<<1)+(A<<2)+(O<<3)+(M<<4)+(b<<5);if(k>42)return console.log("area calculation is wrong"),-100;var S=f[k];if(S.num==0){var h=i!=-1?i:a.distance(this.posMaX,this.posMin)*.5,n=c,o=n/s,v=o*h/e;return g.PI*v*v}if(S.num==0)return console.log("area calculation is wrong"),-100;for(var L=[],B,D=m,E=0;E<S.num;E++){var Z=W[E],V=this.bbox[S.data[E]];B=!1;var q,Y=g.PI;if(r===3)q=ra.multiplyByVector(D,Q.fromElements(V.x,V.y,V.z,1),la),q.z<0&&(B=!0,h==-1&&(Y=g.PI_OVER_FOUR,e=a.magnitude(w)));else{var J=x,F=J.ellipsoid.cartesianToCartographic(V,ir);l(F)?(J.project(F,$),q=ra.multiplyByVector(D,Q.fromElements($.z,$.x,$.y,1),la),q.z<0&&(B=!0)):B=!0}if(B==!0){var h=i!=-1?i:a.distance(this.posMaX,this.posMin)*.5,n=c,o=n/s,v=o*h/e;return Y*v*v}else Z.x=q.x/q.w,Z.y=c-q.y/q.w,L.push(Z)}return Math.abs(ua.computeArea2D(L))};p.prototype.computeCorners=function(t){return p.computeCorners(this,t)};var sr=new a,hr=new a,dr=new a;p.computeCorners=function(t,r){G.typeOf.object("box",t),l(r)||(r=[new a,new a,new a,new a,new a,new a,new a,new a]);let e=t.center,s=t.halfAxes,c=d.getColumn(s,0,sr),i=d.getColumn(s,1,hr),m=d.getColumn(s,2,dr);return a.clone(e,r[0]),a.subtract(r[0],c,r[0]),a.subtract(r[0],i,r[0]),a.subtract(r[0],m,r[0]),a.clone(e,r[1]),a.subtract(r[1],c,r[1]),a.subtract(r[1],i,r[1]),a.add(r[1],m,r[1]),a.clone(e,r[2]),a.subtract(r[2],c,r[2]),a.add(r[2],i,r[2]),a.subtract(r[2],m,r[2]),a.clone(e,r[3]),a.subtract(r[3],c,r[3]),a.add(r[3],i,r[3]),a.add(r[3],m,r[3]),a.clone(e,r[4]),a.add(r[4],c,r[4]),a.subtract(r[4],i,r[4]),a.subtract(r[4],m,r[4]),a.clone(e,r[5]),a.add(r[5],c,r[5]),a.subtract(r[5],i,r[5]),a.add(r[5],m,r[5]),a.clone(e,r[6]),a.add(r[6],c,r[6]),a.add(r[6],i,r[6]),a.subtract(r[6],m,r[6]),a.clone(e,r[7]),a.add(r[7],c,r[7]),a.add(r[7],i,r[7]),a.add(r[7],m,r[7]),r};function vr(t,r){return new d(t.x*r.x,t.x*r.y,t.x*r.z,t.y*r.x,t.y*r.y,t.y*r.z,t.z*r.x,t.z*r.y,t.z*r.z)}p.fromOrientedBoundingBoxs=function(t,r){if(l(r)||(r=new p),!l(t)||t.length===0)return r;let e=[];t.forEach(M=>{let b=this.computeCorners(M);e=e.concat(b)});let s=new a;e.forEach(M=>{a.add(M,s,s)}),a.multiplyByScalar(s,1/e.length,s);let c=new d;e.forEach(M=>{let b=a.subtract(M,s,new a);c=d.add(vr(b,b),c,c)}),d.multiplyByScalar(c,1/(e.length-1),c);let i=d.computeEigenDecomposition(c,Pa);var m=d.clone(i.unitary,r.halfAxes),x=d.getColumn(m,0,Ca),u=d.getColumn(m,1,ba),w=d.getColumn(m,2,Ma);let h=[x,u,w],n=d.fromColumnMajorArray([h[0].x,h[1].x,h[2].x,h[0].y,h[1].y,h[2].y,h[0].z,h[1].z,h[2].z]),o=1/0,v=-1/0,C=1/0,R=-1/0,z=1/0,A=-1/0;e.forEach(M=>{let b=d.multiplyByVector(d.transpose(n,new d),a.subtract(M,s,new a),new a);o=Math.min(o,b.x),v=Math.max(v,b.x),C=Math.min(C,b.y),R=Math.max(R,b.y),z=Math.min(z,b.z),A=Math.max(A,b.z)}),r.center=s;var O=new a((v-o)/2,(R-C)/2,(A-z)/2);return d.multiplyByScale(r.halfAxes,O,r.halfAxes),r};var Rr=p;export{Rr as a};
