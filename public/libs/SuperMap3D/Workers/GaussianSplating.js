import"./chunk-KTMMHDL6.js";import{a as d}from"./chunk-AMRCVYIA.js";import"./chunk-NUC3LT2W.js";import"./chunk-SFC4FDPW.js";var D=function(){let e=!![];return function(s,i){let a=e?function(){if(i){let n=i.apply(s,arguments);return i=null,n}}:function(){};return e=![],a}}(),b=D(void 0,function(){return b.toString().search("(((.+)+)+)+$").toString().constructor(b).search("(((.+)+)+)+$")});b();var h=new Float32Array(1),I=new Int32Array(h.buffer);function A(e){h[0]=e;var s=I[0],i=s>>31&1,a=s>>23&255,n=s&8388607,f;return a==0?f=0:a<113?(f=0,n|=8388608,n=n>>113-a,n&16777216&&(f=1,n=0)):a<142?f=a-112:(f=31,n=0),i<<15|f<<10|n>>13}function F(e,s,i){let{positions:a,scales:n,rotations:f,colors:u}=i;var c=new Uint32Array(s*e*4),l=new Uint8Array(c.buffer),y=new Float32Array(c.buffer);for(let r=0;r<s;r++){y[8*r+0]=a[r*3+0],y[8*r+1]=a[r*3+1],y[8*r+2]=a[r*3+2],l[4*(8*r+7)+0]=u[r*4+0],l[4*(8*r+7)+1]=u[r*4+1],l[4*(8*r+7)+2]=u[r*4+2],l[4*(8*r+7)+3]=u[r*4+3];let o=[n[r*3+0],n[r*3+1],n[r*3+2]],x=[f[r*4+0],f[r*4+1],f[r*4+2],f[r*4+3]],t=[1-2*(x[2]*x[2]+x[3]*x[3]),2*(x[1]*x[2]+x[0]*x[3]),2*(x[1]*x[3]-x[0]*x[2]),2*(x[1]*x[2]-x[0]*x[3]),1-2*(x[1]*x[1]+x[3]*x[3]),2*(x[2]*x[3]+x[0]*x[1]),2*(x[1]*x[3]+x[0]*x[2]),2*(x[2]*x[3]-x[0]*x[1]),1-2*(x[1]*x[1]+x[2]*x[2])].map((w,g)=>w*o[Math.floor(g/3)]),p=[t[0]*t[0]+t[3]*t[3]+t[6]*t[6],t[0]*t[1]+t[3]*t[4]+t[6]*t[7],t[0]*t[2]+t[3]*t[5]+t[6]*t[8],t[1]*t[1]+t[4]*t[4]+t[7]*t[7],t[1]*t[2]+t[4]*t[5]+t[7]*t[8],t[2]*t[2]+t[5]*t[5]+t[8]*t[8]];c[8*r+4]=_(4*p[0],4*p[1]),c[8*r+5]=_(4*p[2],4*p[3]),c[8*r+6]=_(4*p[4],4*p[5])}return c}function _(e,s){return(A(e)|A(s)<<16)>>>0}function L(e,s,i,a){if(s){let n=new Int16Array(e.buffer,e.byteOffset,e.byteLength/2),f=[];for(let u=0,c=n.length;u<c;u+=4){let l=n[u]*a+i.x,y=n[u+1]*a+i.y,r=n[u+2]*a+i.z;f.push(l,y,r)}return new Float32Array(f)}return new Float32Array(e.buffer,e.byteOffset,e.byteLength/4)}function m(e){let s=e.splatCount,i=e.isCompress,{posArray:a,colArray:n,scaArray:f,rotArray:u}=e,c=L(a,i,e.minVerticesValue,e.vertCompressConstant),l=new Uint8Array(n.buffer,n.byteOffset,n.byteLength),y=new Float32Array(f.buffer,f.byteOffset,f.byteLength/4),r=new Float32Array(u.buffer,u.byteOffset,u.byteLength/4),x=F(2,s,{positions:c,scales:y,rotations:r,colors:l});return{bufferPos:c,texData:x}}function U(e,s,i){if(!e)return;let a=new Float32Array(e),n=-1/0,f=1/0,u=new Int32Array(i);for(let o=0;o<i;o++){let x=(s[2]*a[3*o+0]+s[6]*a[3*o+1]+s[10]*a[3*o+2])*4096|0;u[o]=x,x>n&&(n=x),x<f&&(f=x)}let c=(256*256-1)/(n-f),l=new Uint32Array(256*256);for(let o=0;o<i;o++)u[o]=(u[o]-f)*c|0,l[u[o]]++;let y=new Uint32Array(256*256);for(let o=1;o<256*256;o++)y[o]=y[o-1]+l[o-1];let r=new Uint32Array(i);for(let o=0;o<i;o++)r[y[u[o]]++]=o;return e=null,r}function O(e){let{positions:s,modelView:i,count:a,type:n}=e;return n==="sortIndex"?U(s,i,a):m(e)}var V=d(O);export{V as default};
